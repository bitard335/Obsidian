____

tags: #TypeScript  #компилятор-TS #tsconfig 

[[5. TypeScript |На главную]]

links: [[Дополнительные библиотеки для работы с typescript - проектом]] , [[Миграция проекта React на TypeScript]]

 ![Что такое TypeScript?](https://youtu.be/R76_xPjzUd8?t=669)

### keywords:

Пошаговое руководство, как настроить TS-проект с момента объявления проекта до этапа компиляции:
1. Глобально установи компилятор TS командой
```
npm i -g typescript
```
2. Убедись, что установка прошла успешно (в консоли отобразится версия TS)
```
tsc -v
```
3. Создай TypeScript-файл (index.ts) и напиши код. Компиляция производится следующей командой:
```
tsc index
```

#TSC скомпилировал код в JS-файл index.js
Если есть необходимость изменить название файла, то введи следующую команду в консоль: `tsc index.ts --outfile file-name.js`
Если есть необходимость, чтобы TSC компилировал код автоматически, при изменениях, то введи следующую команду в консоль: `tsc index.ts -w`

<b>ВАЖНО</b>
TS сообщает об обнаружении ошибки, но ВСЕ РАВНО СКОМПИЛИРУЕТ КОД, независимо от того, есть в нём ошибки, или нет.

Чтобы TypeScript прерывал компиляцию в случае обнаружения ошибок, нужно использовать флаг `--noEmitOnError`. Этот флаг заставляет компилятор TypeScript прекращать генерацию JavaScript файлов, если в процессе компиляции были найдены ошибки.

Например, если вы используете TypeScript из командной строки, то для того, чтобы включить этот флаг, нужно добавить его в команду компиляции:

```
tsc --noEmitOnError myFile.ts
```

В этом случае, компилятор TypeScript не будет генерировать JavaScript файлы, если в процессе компиляции myFile.ts были найдены ошибки.

Если вы используете среду разработки, то вам нужно будет найти соответствующую настройку, которая позволяет включить флаг `--noEmitOnError`. 
Например, в Visual Studio Code вы можете добавить этот флаг в файл `tsconfig.json`:

```
{
  "compilerOptions": {
    "noEmitOnError": true
  }
}
```

Эта настройка заставит компилятор TypeScript прерывать компиляцию, если в процессе компиляции были найдены ошибки.

4. Данные отобразились! 
   Для того, чтобы не повторять данную операцию для оторбражения данных воспользуем следующим глобальным расширением для ts:
~~~
npm install -g ts-node
~~~

Для отображения данных и компиляции воспользуемся следующим кодом:
~~~
ts-node index.ts
~~~

Таким образом, мы в 1 действие преобразовали файл.

5. Для настройки файла конфигурации `tsconfig.json` воспользуемся следующей командой: 
~~~
`tsc —init`
~~~

6. Установим дополнительные библиотеки для управления нашим TS-проектом.

#### #rimraf
```
npm i @types/rimraf --save-dev
```

В этом примере мы импортируем функцию `rimraf` из модуля `rimraf`. 
Функция `rimraf` принимает первым аргументом путь к файлу или директории, которую нужно удалить, и вторым аргументом функцию обратного вызова, которая будет вызвана после завершения операции удаления.
```
import rimraf from 'rimraf';

rimraf('/path/to/my/file', (err) => {
  if (err) throw err;
  console.log('File has been deleted!');
});
```

#rimraf также может быть полезен при автоматическом удалении сгенерированных файлов в процессе разработки или при сборке проекта. Например, если вы генерируете временные файлы в процессе работы приложения, которые должны быть удалены после завершения работы, вы можете использовать `rimraf`, чтобы гарантировать, что эти файлы будут удалены.

#### #copyfiles

```
npm i @types/copyfiles --save-dev
```

После установки пакета типов `copyfiles` вы можете использовать его в своем TypeScript коде:

```
import { copyFiles } from 'copyfiles';

copyFiles(['/path/to/source/**/*', '/path/to/destination'], true, () => {
  console.log('Files have been copied!');
});
```
`copyfiles` - это полезный инструмент для копирования файлов и директорий в Node.js приложении. Он позволяет скопировать файлы и директории с сохранением структуры файловой системы и может быть использован в различных сценариях, связанных с копированием файлов и директорий в Node.js приложении.

#### #npm-watch

```
npm i npm-watch --save-dev
```

После установки `npm-watch` вы можете добавить скрипты в файл `package.json`, которые будут запускаться при изменении файлов. Например, чтобы автоматически компилировать TypeScript файлы при их изменении, вы можете добавить следующий скрипт в `package.json`:

```
"scripts": {
  "watch": "npm-watch tsc -- --watch"
}
```

Этот скрипт запускает компилятор TypeScript (`tsc`) с флагом `--watch`, который заставляет компилятор следить за изменениями файлов и автоматически перекомпилировать проект при их изменении.

Чтобы запустить этот скрипт, введите следующую команду в терминале:

```
npm run watch
```

После этого компилятор TypeScript будет запущен в режиме наблюдения и будет автоматически перекомпилировать проект при изменении файлов.

Подробнее: [[Дополнительные библиотеки для работы с typescript - проектом]]
_____

## Вступление

TypeScript - это расширенная версия JavaScript. То есть он содержит в себе все то же самое, что и JavaScript, но с некоторыми дополнениями. TypeScript был разработан #Microsoft и первоначально выпущен в 2012 году.

Главная причина использовать TypeSciprt - это возможность добавить [[Статическая типизация|статическую типизацию]] к JavaScript. Тип переменной со статической типизацией не может быть изменен после ее объявления. Это может предотвратить БОЛЬШОЕ количество багов.
[[Плюсы использования TypeScript]] 

С другой стороны, JavaScript - динамически типизированный язык, то есть типы переменных могуть изменяться. Например:

```
// JavaScript
let foo = "Привет";
foo = 55; // тип переменной foo изменяется со строки на число - никаких проблем

// TypeScript
let foo = "Привет";
foo = 55; // ERROR - тип переменной foo не может быть изменен
```

TypeScript не воспринимается браузерами, поэтому его надо скомпилировать в JavaScript с помощью TypeScript Compiler ( #TSC ).

## Как настроить TypeScript-проект?

Для начала убедитесть, что [Node](https://nodejs.org/en/download/) глобально установлена на вашей машине.

Затем, глобально установите компилятор TypeScript на вашей машине следующей командой:

```
npm i -g typescript
```

Убедитесь, что установка прошла успешно (если да - то команда вернет номер версии).

```
tsc -v
```

## Как компилировать TypeScript-проект?

Откройте любой текстовые редактор и создайте TypeScript-файл (например, index.ts).

Напишите какой-нибудь код на JavaScript или TypeScript:

```
let sport = 'Футбол';
let id = 5;
```

Мы можем скомпилировать это в JavaScript следующей командой:

```
tsc index
```

TSC скомпилирует код в JavaScript-файл `index.js`:

```
var sport = 'Футбол';
var id = 5;
```

Если вы хотите изменить название файла:

`tsc index.ts --outfile file-name.js`

Если вы хотите, чтобы TSC компилировал ваш код автоматически, при изменениях, добавьте флаг “watch” (-w):

`tsc index.ts -w`

Интересная особенность TypeScript - он сообщает об ошибках в вашем текстовом редакторе, пока вы пишете код, но он все равно всегда скомпилирует ваш код - в независимости от того, есть в нем ошибки, или нет.

Например, следующий пример вызывает ошибку TypeScript:

```
var sport = 'Футбол';
var id = 5;
id = '5'; // Ошибка компилятора - Error: Type 'string' is not assignable to type 'number'.
```

Однако если мы попытаемся скомпилировать код с помощью `tsc index` , код скомпилируется, несмотря на ошибку.

Это важное преимущество TypeScript: он предполагает, что разработчик знает больше. Несмотря на то, что TypeScript выдает ошибку, это не отразится на компиляции вашего кода. Он скажет, что есть ошибка, но делать с ней что-то или нет - решать вам.

## Как настроить файл конфигурации TypeScript ?

Файл конфигурации TS должен находиться в корневой директории вашего проекта. 
В этом файле мы можем указать корневой файл, опции компилятора и насколько строго мы хотим, чтобы TypeScript делал проверку в нашем проекте.

Сначала создаейте файл конфигурации TS:

~~~
`tsc —init`
~~~

После этого, в корневой директории, у вас должен появиться файл `tsconfig.json` .

Вот пример некоторых опций, о которых стоит знать (если вы используете frontend-фреймворк с TypeScript, то о большинстве этих вещей уже позаботились):

```
{
    "compilerOptions": {
        ...
        /* Модули */
        "target": "es2016", // Измените на "ES2015", чтобы скомпилировать в ES6
        "rootDir": "./src", // Откуда компилировать
        "outDir": "./public", // Куда компилировать (обычно папка, которая разворачивается на сервере)
        /* Поддержка JavaScript */
        "allowJs": true, // Позволяет компилировать JS-файлы
        "checkJs": true, // Проверяет типы в JavaScript-файлах и сообщает об ошибках

        /* Emit */
        "sourceMap": true, // Создать source map файлы для готовых файлов JavaScript (хороошо подходит для дебаггинга)
        "removeComments": true, // Игнорировать комментарии
    },

  	"include": ["src"] // Компилировать только файлы из папки src
}
```

Скомпилировать все и наблюдать за изменениями:
~~~
`tsc -w`
~~~

Напоминание: если вы указываете входные файлы в коммандной строке (например, `tsc index` ), файлы `tsconfig.json` будут игнорироваться.
